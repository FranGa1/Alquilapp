
<div class="mb-11vh mt-11vh d-flex justify-content-center">
    <div class="d-flex flex-column " style="width:80%">
        <h4 class="p-2 align-self-start">Tu alquiler, <%=current_user.first_name %></h4>
        <div class="card align-self-center" style="width: 16rem;">
            <%if @auto.imagen.attached?%>
                <%= image_tag(@auto.imagen) %></td>
            <%else%>
                <label>Sin Foto</label>
            <%end%>
            <div class="card-body">
                <h5 class="card-title" style="font-size:1rem"><%=@auto.modelo%></h5>
            </div>
        </div>
        <div class="m-4">
            <h6>Tiempo restante:  <h6>
                <div class="text-center" id="countdown"></div>
        </div>
        <%= link_to "Finalizar alquiler", "/users/finalizar_alquiler", method: :put, class: "btn btn-    align-self-center" %>
    </div>
    <%# add a link to finish the rental %>

</div>


<script>
    // function that given a month number return the first three letters of the month
    function getMonthName(monthNumber) {
        var monthNames = ["Jan", "Feb", "Mar", "Apr", "May", "Jun",
            "Jul", "Aug", "Sep", "Oct", "Nov", "Dec"
        ];
        return monthNames[monthNumber-1];
    }

   // Set the date we're counting down to
   var month = <%= @alquiler.fecha_devolucion.month %>
    var day = "<%= @alquiler.fecha_devolucion.day %>"
    var year = "<%= @alquiler.fecha_devolucion.year %>"

    var countDownDate = new Date(`${getMonthName(month)} ${day}, ${year} <%= @tiempo_fin %>`).getTime();
    // Update the count down every 1 second
    var x = setInterval(function() {

        // Get today's date and time
        var now = new Date().getTime();
        // format and display now


        // Find the distance between now and the count down date
        var distance = countDownDate - now;


        // Time calculations for days, hours, minutes and seconds
        var days = Math.floor(distance / (1000 * 60 * 60 * 24));
        var hours = Math.floor((distance % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
        var minutes = Math.floor((distance % (1000 * 60 * 60)) / (1000 * 60));
        var seconds = Math.floor((distance % (1000 * 60)) / 1000);

        // Display the result in the element with id="demo"
        document.getElementById("countdown").innerHTML =  days + "d " +  hours + "h "
        + minutes + "m " + seconds + "s ";

        // If the count down is finished, write some text
        if (distance < 0) {
            clearInterval(x);
            document.getElementById("countdown").innerHTML = "EXPIRED";
        }
    }, 1000);


</script>
